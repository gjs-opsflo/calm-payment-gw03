{
  "nodes": [
    {
      "unique-id": "customer",
      "node-type": "actor",
      "name": "Customer",
      "description": "End user making a payment transaction through the checkout process"
    },
    {
      "unique-id": "checkout-page",
      "node-type": "webclient",
      "name": "Checkout Page",
      "description": "PCI-DSS compliant payment form for secure card data entry",
      "controls": {},
      "data-classification": "CONFIDENTIAL"
    },
    {
      "unique-id": "payment-api",
      "node-type": "service",
      "name": "Payment API",
      "description": "Payment processing endpoint orchestrating tokenization, fraud detection, and authorization",
      "controls": {},
      "data-classification": "RESTRICTED"
    },
    {
      "unique-id": "tokenization-service",
      "node-type": "service",
      "name": "Tokenization Service",
      "description": "PCI-DSS card tokenization service replacing sensitive card data with tokens",
      "controls": {},
      "data-classification": "RESTRICTED"
    },
    {
      "unique-id": "fraud-detection",
      "node-type": "service",
      "name": "Fraud Detection",
      "description": "ML-based fraud scoring engine analyzing transaction patterns and risk indicators",
      "controls": {}
    },
    {
      "unique-id": "transaction-database",
      "node-type": "database",
      "name": "Transaction Database",
      "description": "Payment transaction records and authorization history",
      "controls": {},
      "data-classification": "CONFIDENTIAL"
    },
    {
      "unique-id": "card-network",
      "node-type": "system",
      "name": "Card Network",
      "description": "External card network (Visa/Mastercard) for authorization and settlement",
      "controls": {}
    },
    {
      "unique-id": "cardholder-data",
      "node-type": "data-asset",
      "name": "Cardholder Data",
      "description": "PCI-DSS scoped cardholder data including PAN, CVV, and expiration date",
      "controls": {}
    }
  ],
  "relationships": [
    {
      "unique-id": "customer-to-checkout",
      "description": "Customer enters payment information on checkout page",
      "relationship-type": "interacts",
      "interacts": {
        "actor": "customer",
        "nodes": [
          "checkout-page"
        ]
      }
    },
    {
      "unique-id": "checkout-to-payment-api",
      "description": "Checkout page submits encrypted payment data to payment API",
      "protocol": "HTTPS",
      "relationship-type": "connects",
      "connects": {
        "source": {
          "node": "checkout-page"
        },
        "destination": {
          "node": "payment-api"
        }
      }
    },
    {
      "unique-id": "payment-api-to-tokenization",
      "description": "Payment API requests card tokenization",
      "protocol": "mTLS",
      "relationship-type": "connects",
      "connects": {
        "source": {
          "node": "payment-api"
        },
        "destination": {
          "node": "tokenization-service"
        }
      }
    },
    {
      "unique-id": "payment-api-to-fraud",
      "description": "Payment API checks transaction for fraud indicators",
      "protocol": "HTTPS",
      "relationship-type": "connects",
      "connects": {
        "source": {
          "node": "payment-api"
        },
        "destination": {
          "node": "fraud-detection"
        }
      }
    },
    {
      "unique-id": "payment-api-to-db",
      "description": "Payment API persists transaction records",
      "protocol": "JDBC",
      "relationship-type": "connects",
      "connects": {
        "source": {
          "node": "payment-api"
        },
        "destination": {
          "node": "transaction-database"
        }
      }
    },
    {
      "unique-id": "tokenization-to-card-network",
      "description": "Tokenization service forwards authorization request to card network",
      "protocol": "mTLS",
      "relationship-type": "connects",
      "connects": {
        "source": {
          "node": "tokenization-service"
        },
        "destination": {
          "node": "card-network"
        }
      }
    }
  ],
  "controls": {},
  "flows": [
    {
      "unique-id": "payment-processing-flow",
      "name": "Payment Processing Flow",
      "description": "Complete payment flow from customer card entry through authorization",
      "transitions": [
        {
          "relationship-unique-id": "customer-to-checkout",
          "sequence-number": 1,
          "description": "Customer enters card details on checkout page"
        },
        {
          "relationship-unique-id": "checkout-to-payment-api",
          "sequence-number": 2,
          "description": "Checkout submits encrypted payment to API"
        },
        {
          "relationship-unique-id": "payment-api-to-fraud",
          "sequence-number": 3,
          "description": "Payment API checks fraud score"
        },
        {
          "relationship-unique-id": "payment-api-to-tokenization",
          "sequence-number": 4,
          "description": "Payment API requests tokenization"
        },
        {
          "relationship-unique-id": "tokenization-to-card-network",
          "sequence-number": 5,
          "description": "Tokenization service authorizes with card network"
        },
        {
          "relationship-unique-id": "payment-api-to-db",
          "sequence-number": 6,
          "description": "Payment API records transaction"
        }
      ]
    }
  ]
}